name: tools_opx-py
description: OpenSwitch ONIE Installer
repository: "https://github.com/open-switch/tools_opx-py"
skip_queued_branch_builds: true
skip_queued_branch_builds_filter: "!master"
provider_settings:
  build_pull_request_forks: true
  build_pull_requests: true
  build_tags: true
  prefix_pull_request_fork_branch_names: true
  publish_commit_status: true
  publish_commit_status_per_step: false
  pull_request_branch_filter_enabled: false
  skip_pull_request_builds_for_existing_commits: true
  trigger_mode: "code"
steps:
  - name: ":python: Coverage"
    type: script
    command: |
      pipenv install --deploy --dev
      pipenv run pytest --cov=opx/ tests/ --cov-report=xml --cov-report=term
      bash <(curl -s https://codecov.io/bash)
  - type: waiter
  - name: ":llama: Lint"
    type: script
    command: |
      pipenv install --deploy --dev
      pipenv run pylama opx --skip '*/__init__.py'
